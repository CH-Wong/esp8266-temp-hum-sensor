<!-- const char MAIN_page[] PROGMEM = R"=====( -->
<!doctype html>
<html>

<head>
	<title>Meadery Metrology</title>
	<!-- <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"> -->
	<!-- <link rel="stylesheet" type="text/css" href="style.css"> -->
	<style>
	html, body {
		font-family: Arial, Helvetica, sans-serif;
		width: 100%;
		height: 100%;
		position: relative;
	}
		.container {
		  width: 70%;
		  height: 70%;
			margin: auto;
		}
	</style>

	<script src = "https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
</head>


<body>
		<div class="container">
			<h1>Chiefer Meadery Metrology</h1>
	    <canvas id="myChart"></canvas>
	  </div>

<script>
	tempData = [];
	humData = [];
	timeData = [];

	const N = 744
	for (var i = N - 1; i >= 0; i--) {
	   timeData.push(i);
		 tempData.push(0);
		 humData.push(0);
	}

	showGraph();
	function showGraph() {
		var myChart = new Chart(document.getElementById('myChart'), {
			type: 'line',
			data: {
				labels: timeData,
				datasets: [
					{
						label: 'Temperature [C]',
						data:  tempData,
						borderColor: '#b32400',
						backgroundColor: '#b32400',
						yAxisID: 'T',
						fill: false
					}
					,
					{
						label: 'Humidity [%]',
						data: humData,
						yAxisID: 'H',
						borderColor: '#002db3',
						backgroundColor: '#002db3',
						fill: false
					}
				]
			}
			,
			options: {
				legend: {
					position: 'right'
				},
				scales: {
					beginAtZero: true,
					yAxes: [{
							id: 'T',
							gridLines: {
								display: true,
								drawOnChartArea: false,
								color: '#b32400',
							},
							type: 'linear',
							position: 'left',
							scaleLabel: {
								display: true,
								labelString: 'Temperature [C]',
								fontColor: '#b32400',
							},
							ticks: {
								min: 0,
								color: '#b32400',
								fontColor: '#b32400',
								fontSize: 18,
								padding: 10
							}
						},
						{
							id: 'H',
							gridLines: {
								display: true,
								drawOnChartArea: false,
								color: '#002db3',
							},
							type: 'linear',
							position: 'right',
							scaleLabel: {
								display: true,
								labelString: 'Humidity [%]',
								fontColor: '#002db3'
							},
							ticks: {
								min: 0,
								max: 100,
								color: '#002db3',
								fontColor: '#002db3',
								fontSize: 18,
								padding: 10
							}
						}],
					xAxes: [{
						// type: 'time',
						gridLines: {
							display: true,
							drawOnChartArea: false,
						},
						scaleLabel: {
							display: true,
							labelString: 'Time passed [h]'
						},
						ticks: {
							padding: 10,
							fontSize: 18
						}
					}]
				}
		  }
		});
	};


	setInterval(function() {
		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
					var humStr = this.responseText;
					humData = humStr.split(",");
			}
		};
		xhttp.open("GET", "/humidity", true);
		xhttp.send();
	}, 3600000);

	setInterval(function () {
		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
					var tempStr = this.responseText;
					tempData = tempStr.split(",");
					showGraph();
			}
		};
		xhttp.open("GET", "/temperature", true);
		xhttp.send();
	}, 3600000);


</script>

</body>

</html>
